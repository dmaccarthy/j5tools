function qsAll(t){var a={};return t=(t?t:location.search.slice(1)).split("&"),t.forEach(function(t,e,n){t=t.split("=");var r=decodeURIComponent(t[0].trim());a[r]||(a[r]=[]),a[r].push(t.length>1?decodeURIComponent(t[1].trim()):null)}),a}function qsFirst(t){var a,e=qsAll(t);for(a in e)e[a]=e[a][0];return e}function latex(t,a){t=l._elem(t);for(var e=0;e<t.length;e++){var n=$(t[e]),r=n.find("img");if(a||0==r.length){var l,o="\\dpi{"+l._dpi(n)+"}",i=r.length?r.attr("data-latex"):n.html(),c=n.attr("data-color").trim();c?(c="{"==c.charAt(0)?"[RGB]"+c:"{"+c+"}",l="{\\color"+c+i+"}"):l=i;var d="http://latex.codecogs.com/png.latex?"+encodeURIComponent(o+l);n.html($("<img>").attr({src:d,alt:"Equation","data-latex":i}))}}}latex._elem=function(t){return null==t?t=$(".latex"):t[0]||(t=[t]),t},latex._dpi=function(t){var a=t.attr("data-zoom");return a=6*parseFloat(t.css("fontSize"))*(a?parseFloat(a):1),Math.round(a)},latex.unrender=function(t){t=latex._elem(t);for(var a=0;a<t.length;a++){var e=$(t[a]),n=e.find("img");n.length&&e.html(n.attr("data-latex"))}};function Plot(t,e,r){"string"==typeof t&&(t=$(t)[0]),null==r&&(r=0),"number"==typeof r&&(r=[r,r]),2==r.length&&(r.push(r[0]),r.push(r[1]));var o=parseInt(t.getAttribute("width")),i=parseInt(t.getAttribute("height")),n=-1,a=1;e?(n=e[0],a=e[1]):e=[];var l,s,h,c=(o-1-(r[0]+r[1]))/(a-n);if(e.length>2&&(s=e[2],e.length>3&&(h=e[3])),null==h){l=-c;var u=(i-1-(r[2]+r[3]))/c;null==s?(h=u/2,s=-h):h=s+u}else l=(i-1-(r[2]+r[3]))/(s-h);this.cv=t,this.size=[o,i],this.coeff=[c,r[0]-c*n,l,r[3]-l*h],this.ccw=this.coeff[0]*this.coeff[2]<0,this.limit=[n,a,s,h];for(var f=!1,p=0;4>p;p++)r[p]&&(f=!0);this.clip=f?[r[0],r[3],o-(r[0]+r[1]),i-(r[2]+r[3])]:!1,this.resetTime()}function _ticks(t,e,r){if(!r||1==r&&"boolean"==typeof r)return[];for(var o=Math.floor(t/r),i=Math.ceil(e/r),n=[];i>=o;)n.push(r*o++);return n}function _gridRound(t){var e=Math.floor(Math.log(t)/Math.log(10)),r=Math.pow(10,e);return t/=r,t=Math.round(t),t>5&&t%2&&(t+=1),10==t&&(t=1,e++,r*=10),[t*r,e,t]}function _textHeight(t,e){var r=document.createElement("span");r.setAttribute("style","font:"+e),r.textContent=t,document.body.appendChild(r);var o=r.offsetHeight;return document.body.removeChild(r),o}function _anchor(t,e,r){var o=3&r,i=12&r;return t=[t[0]-o*e[0]/2,t[1]-i*e[1]/8]}function closestPixel(t){return[Math.round(t[0]+.5)-.5,Math.round(t[1]+.5)-.5]}function arrow(t,e,r,o,i){var n=e[0]-t[0],a=e[1]-t[1],l=Math.sqrt(n*n+a*a),s=_arrow(l,r,o,i),h=n/l,c=a/l,u=[[h,-c],[c,h]];return transformAll(s,u,t)}function _arrow(t,e,r,o){null==e&&(e=t/10),null==r&&(r=1.5*e),null==o&&(o=1);var i=t-r,n=e/2,a=r*o/Math.sqrt(3);return n>a&&(a=n),t/4>i&&(i=t/4),[[0,n],[i,n],[i,a],[t,0],[i,-a],[i,-n],[0,-n]]}function transform(t,e,r){for(var o=new Array(e.length),i=0;i<o.length;i++){for(var n=0,a=0;a<t.length;a++)n+=t[a]*e[i][a];o[i]=r?n+r[i]:n}return o}function transformAll(t,e,r){for(var o=new Array(t.length),i=0;i<t.length;i++)o[i]=transform(t[i],e,r);return o}function _fillStroke(t,e,r,o){e&&(t.fillStyle=e,t.fill()),r&&(t.strokeStyle=r,t.lineWidth=null==o?1:o,t.stroke())}function ImagePreload(t,e,r){"string"==typeof t&&(t=[t]);var o=t.length;this.img=new Array(o),e&&(this.success=e),this.complete=!1;for(var i=0;o>i;i++){var n,a=t[i];a instanceof Array?(n=new Image(a[1],a[2]),a=a[0]):n=new Image,this.img[i]=n,n["data-array"]=this,e&&(n.onload=function(){var t=this["data-array"];!t.complete&&t.done()&&(t.complete=!0,t.success())}),r&&(n.onerror=r),n.src=a}}var PI=Math.PI,DEG=PI/180,RAD=180/PI,TWO_PI=2*PI;Plot.prototype.left=function(){return this.limit[0]},Plot.prototype.right=function(){return this.limit[1]},Plot.prototype.bottom=function(){return this.limit[2]},Plot.prototype.top=function(){return this.limit[3]},Plot.prototype.corner=function(t){var e=1==t||4==t?0:1,r=2>t?3:2;return[this.limit[e],this.limit[r]]},Plot.prototype.resetTime=function(){this._time=(new Date).getTime()},Plot.prototype.time=function(){return(new Date-this._time)/1e3},Plot.prototype["native"]=function(){var t=this.cv,e=parseInt(t.getAttribute("width")),r=parseInt(t.getAttribute("height"));return new Plot(t,[0,e-1,r-1,0])},Plot.prototype.pixels=function(t,e){var r=Math.abs(this.coeff[0]),o=Math.abs(this.coeff[2]);return e&&(r=1/r,o=1/o),t instanceof Array?[t[0]*r,t[1]*o]:t*Math.sqrt(r*o)},Plot.prototype.coords=function(t,e){var r=this.coeff,o=r[1],i=r[2],n=r[3];return r=r[0],e?[(t[0]-o)/r,(t[1]-n)/i]:[r*t[0]+o,i*t[1]+n]},Plot.prototype.cxBegin=function(t,e){var r=this.cv.getContext("2d");return r.save(),t&&(r.globalAlpha=t),e&&(r.beginPath(),e=this.clip,r.rect(e[0],e[1],e[2],e[3]),r.clip()),r.beginPath(),r},Plot.prototype.arc=function(t,e,r,o,i){var n=this.cxBegin(i.alpha,i.clip),a=this.coords(t);if(this.ccw){var l=-r;r=-o,o=l}n.arc(a[0],a[1],this.pixels(e),r,o),i.sector&&(n.lineTo(a[0],a[1]),n.closePath()),_fillStroke(n,i.fill,i.stroke,i.lineWidth),n.restore()},Plot.prototype.circle=function(t,e,r){this.arc(t,e,0,TWO_PI,r,!1)},Plot.prototype.connect=function(t,e,r,o,i,n,a){var l=this.cxBegin(n,a),s=closestPixel(this.coords(t[0]));l.moveTo(s[0],s[1]);for(var h=1;h<t.length;h++)s=closestPixel(this.coords(t[h])),l.lineTo(s[0],s[1]);i&&l.closePath(),_fillStroke(l,e,r,o),l.restore()},Plot.prototype._gridSegments=function(t,e,r,o,i,n){for(var a=0;a<t.length;a++){var l=t[a],s=o?[[e,l],[r,l]]:[[l,e],[l,r]];this.connect(s,null,i,n)}},Plot.prototype.grid=function(t){var e;t.alpha&&(e=this.cv.getContext("2d"),e.save(),e.globalAlpha=t.alpha);var r,o,i=this.limit,n=i[0],a=i[1],l=i[2],s=i[3],h=_ticks(n,a,t.x),c=_ticks(l,s,t.y);t.gridStyle&&(r=t.gridStyle[0],o=t.gridStyle[1],this._gridSegments(h,l,s,!1,r,o),this._gridSegments(c,n,a,!0,r,o)),t.axisStyle&&(r=t.axisStyle[0],o=t.axisStyle[1],t.x&&this.connect([[n,0],[a,0]],null,r,o),t.y&&this.connect([[0,l],[0,s]],null,r,o));var u=this.pixels([1,1],!0);if(t.tickStyle){var f=t.tickStyle;r=f[0],o=f[1];var p=f[2],d=f.length>3?f[3]:-p/2,g=p+d;this._gridSegments(h,d*u[0],g*u[0],!1,r,o),this._gridSegments(c,d*u[1],g*u[1],!0,r,o)}var v,f,m;if(t.xLabel)for(f=t.xLabel,m=f.length<5?Plot.fixed:f[4],v=0;v<h.length;v++)this.text(m(h[v],f[3]),[h[v],f[2][1]*u[1]],f[1],f[0],f[2][0]);if(t.yLabel)for(f=t.yLabel,m=f.length<5?Plot.fixed:f[4],v=0;v<c.length;v++)this.text(m(c[v],f[3]),[f[2][1]*u[0],c[v]],f[1],f[0],f[2][0]);t.alpha&&e.restore()},Plot.prototype.optimalGrid=function(t){null==t&&(t=12);var e=_gridRound((this.right()-this.left())/t),r=_gridRound((this.top()-this.bottom())/t);return{dx:e,dy:r}},Plot.fixed=function(t,e){return t.toFixed(e)},Plot.optimalLabel=function(t,e){return t?Math.abs(e)>1?(t/Math.pow(10,e)).toFixed(0):t.toFixed(-1==e?1:0):""},Plot.prototype.plot=function(t,e){var r=e.fill,o=e.stroke,i=e.marker,n=e.alpha;if((r||o)&&this.connect(t,r,o,e.lineWidth,e.closed,n),i)for(var a=0;a<t.length;a++)this.blit(i,t[a],{anchor:CENTER,size:e.markerSize,rotate:e.markerRotate,alpha:n,clip:e.clip})},Plot.prototype.locus=function(t,e,r,o){null==r&&(r={});for(var i=null==r.start?this.left():r.start,n=null==r.end?this.right():r.end,a=r.steps?r.steps:Math.max(1,Math.round(Math.abs(this.coeff[0]*(n-i)))),l=(n-i)/a,s=new Array(a+1),h=0;a>=h;h++)s[h]=t(i+h*l,o);this.plot(s,e)},Plot.prototype.blit=function(t,e,r){null==r&&(r={});var o=r.size?this.pixels(r.size):[t.width,t.height];if("number"==typeof o){var i=o/Math.sqrt(Math.abs(t.width*t.height));o=[i*t.width,i*t.height]}e=this.coords(e);var n=o;if(r.rotate){var a=Math.sin(r.rotate),l=Math.cos(r.rotate),s=[[l,-a],[a,l]],h=transform(o,s),c=Math.abs(h[1]);h=Math.abs(h[0]);var u=transform([o[0],-o[1]],s),f=Math.abs(u[1]);u=Math.abs(u[0]),n=[Math.max(h,u),Math.max(c,f)]}r.anchor&&(e=_anchor(e,n,r.anchor));var p=this.cxBegin(r.alpha,r.clip);p.translate(e[0]+n[0]/2,e[1]+n[1]/2),r.rotate&&p.rotate(this.ccw?-r.rotate:r.rotate),p.drawImage(t,-o[0]/2,-o[1]/2,o[0],o[1]),p.restore()},Plot.prototype.arrow=function(t,e,r,o){null==o&&(o={});var i=arrow(this.coords(t),this.coords(e),o.tailWidth,o.headLength,o.flatness);!r.stroke||"closed"in r||(r.closed=!0),this["native"]().plot(i,r)},Plot.prototype.clear=function(t,e){t=t?this.coords(t):[0,0],e=e?this.pixels(e):[this.cv.width,this.cv.height],this.cv.getContext("2d").clearRect(t[0],t[1],e[0],e[1])},Plot.prototype.fill=function(t){var e=this.cv,r=e.getContext("2d");r.fillStyle=t,r.fillRect(0,0,e.width,e.height)},Plot.prototype.text=function(t,e,r,o,i,n,a){var l=this.cxBegin(n,a);l.font=r,l.fillStyle=o,null!=i&&(l.textAlign=["left","center","right"][3&i],l.textBaseline=["top","middle","alphanumeric"][(12&i)/4]),e=this.coords(e),l.fillText(t,e[0],e[1]),l.restore()},Plot.prototype.eventCoords=function(t,e){var r=$(this.cv),o=parseFloat(r.css("padding-left"))+parseFloat(r.css("border-left-width")),i=parseFloat(r.css("padding-top"))+parseFloat(r.css("border-top-width")),n=this.cv.getBoundingClientRect();return o=(t.clientX-n.left-o)*this.cv.width/r.width(),i=(t.clientY-n.top-i)*this.cv.height/r.height(),e?[o,i]:this.coords([o,i],!0)},Plot.image=function(t,e,r,o){var i=document.createElement("canvas");return i.width=e[0],i.height=e[1],t(new Plot(i,r,o)),img=new Image(i.width,i.height),img.src=i.toDataURL("image/png"),img},Plot.renderText=function(t,e,r,o){var i=document.createElement("canvas"),n=i.getContext("2d");n.font=e;var a=n.measureText(t);t+="  jM";var l=_textHeight(t,e);return Plot.image(function(i){i["native"]().text(t,[0,0],e,r,NW,o)},[parseInt(a.width)+1,l])};var NW=0,NORTH=1,NE=2,WEST=4,CENTER=5,EAST=6,SW=8,SOUTH=9,SE=10;ImagePreload.prototype.loaded=function(){for(var t=0,e=0;e<this.img.length;e++)try{this.img[e].complete&&t++}catch(r){}return t},ImagePreload.prototype.done=function(){return this.loaded()==this.img.length};var Marker={};Marker.cross=function(t,e,r,o,i,n){return Plot.image(function(t){var a=[[e,1],[e,e],[1,e],[1,-e],[e,-e],[e,-1],[-e,-1],[-e,-e],[-1,-e],[-1,e],[-e,e],[-e,1]];t.connect(a,r,o,i,!0,n)},t,[-1,1,-1,1],Math.round(i/2))},Marker.rect=function(t,e,r,o,i){return Plot.image(function(t){t.connect([[0,0],[0,1],[1,1],[1,0]],e,r,o,!0,i)},t,[0,1,0,1],Math.round(o/2))},Marker.circ=function(t,e,r,o,i){var n=2*t;return Plot.image(function(t){t.circle([0,0],1,{fill:e,stroke:r,lineWidth:o,alpha:i})},[n,n],[-1,1,-1,1],Math.round(o/2))},Marker.tri=function(t,e,r,o,i){return"number"==typeof t&&(t=[t,Math.round(t*Math.sqrt(3)/2)]),Plot.image(function(t){t.connect([[0,0],[1,0],[.5,1]],e,r,o,!0,i)},t,[0,1,0,1],Math.round(o/2))};